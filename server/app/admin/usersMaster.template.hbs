<div class="container mt-3">
    <div class="row">
        <div class="col">
            <h1>Users</h1>
        </div>
    </div>
</div>


<div class="bg-primary mt-3">
    <div class="container">
        <div class="row">
            <div class="col">

                <div class="input-group py-3">
                    <input type="text" class="form-control" placeholder="Search users" autocomplete="off">
                    <div class="input-group-append">
                        <button class="btn btn-secondary btn-large">
                            <i class="fa fa-search" aria-hidden="true"></i>
                            <span class="ml-1">Search</span>
                        </button>
                    </div>
                </div>

                <div class="input-group py-3">
                    <input id="users-typeahead" type="text" class="form-control" placeholder="Search users">
                    <div class="input-group-append">
                        <button class="btn btn-secondary btn-large">
                            <i class="fa fa-search" aria-hidden="true"></i>
                            <span class="ml-1">Search</span>
                        </button>
                    </div>
                </div>


            </div>
        </div>
    </div>
</div>


<div class="container mt-3">
    <div class="row">
        <div class="col">

            <table class="table mt-3">
                <thead>
                    <tr>
                        <th class="text-center">First Name</th>
                        <th class="text-center">Last Name</th>
                        <th class="text-center">Username</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {{#each users}}
                    <tr>
                        <td class="text-center">{{firstName}}</td>
                        <td class="text-center">{{lastName}}</td>
                        <td class="text-center">{{username}}</td>
                        <td><a href="/user/edit/{{userId}}" data-route-link><i class="fa fa-pencil"></i></a></td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>

        </div>
    </div>
</div>

<script>
    $(document).ready(function() {

        var my_Suggestion_class = new Bloodhound({
            limit: 10,
            datumTokenizer: Bloodhound.tokenizers.obj.whitespace("value"),
            queryTokenizer: Bloodhound.tokenizers.whitespace,
            identify: function(datum) {
                return datum.id;
            },
            prefetch: {
                url: "/api/users/search/prefetch",
            },
            remote: {
                url: "/api/users/search/query",
                wildcard: "query",
                transform: function(datum) {

                    debugger
                    my_Suggestion_class.add(datum);
                    return datum;
                },
            },
            sufficient: 1,
        });

        //Initialize the Suggestion Engine
        my_Suggestion_class.initialize();

        var typeahead_elem = $('#users-typeahead');
        typeahead_elem.typeahead({
            hint: true,
            highlight: true,
            minLength: 1
        },
            {
                name: 'value',
                displayKey: 'value',
                source: my_Suggestion_class.ttAdapter(),
                templates: {
                    empty: [
                        '<div class="noitems">',
                        'No Items Found',
                        '</div>'
                    ].join('\n')
                }
            });

            console.log(typeahead_elem.parent());
    });

</script>